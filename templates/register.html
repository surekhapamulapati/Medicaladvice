{% extends "base.html" %}

{% block title %}Register | MedVice{% endblock %}

{% block content %}

<section class="hero">
    <div class="container hero-content">
        <h2>Create Your MedVice Account</h2>
        <p>oin MedVice today and take control of your health.</p>
    </div>
</section>

<section class="features">
    <div class="container">
        <form action="{{ url_for('register') }}" method="post"
              class="card-content"
              style="max-width: 500px; margin: auto; background: white;
                     border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.08);
                     padding: 35px;">

            <!-- Full Name -->
            <div style="margin-bottom: 20px;">
                <label>Full Name</label>
                <input type="text" name="full_name" required
                       class="modern-input">
            </div>

            <!-- Email -->
            <div style="margin-bottom: 20px;">
                <label>Email</label>
                <input type="email" name="email" required
                       class="modern-input">
            </div>

            <!-- Phone -->
            <div style="margin-bottom: 20px;">
                <label>Phone Number</label>
                <input type="tel" id="phone" name="phone" required
                       class="modern-input">
            </div>

            <!-- Username -->
            <div style="margin-bottom: 20px;">
                <label>Username</label>
                <input type="text" name="username" required
                       class="modern-input">
            </div>

            <!-- Password -->
            <div style="margin-bottom: 10px; position: relative;">
                <label>Password</label>
                <input type="password" id="password" name="password" required
                       class="modern-input">

                <!-- Eye Icon -->
                <i class="fa-solid fa-eye"
                   id="togglePassword"
                   style="position:absolute; right:15px; top:42px; cursor:pointer; color:#888;"></i>
            </div>

            <!-- Password Strength -->
            <div style="margin-bottom: 20px;">
                <div id="strengthBar"
                     style="height:6px; border-radius:10px; background:#eee;"></div>
                <small id="strengthText"></small>
            </div>

            <!-- Button -->
            <button type="submit"
                    style="width:100%; padding:12px; border:none;
                           background:linear-gradient(135deg,#1d3557,#457b9d);
                           color:white; border-radius:10px;
                           font-weight:bold; cursor:pointer;
                           transition:0.3s;">
                Create Account
            </button>

            <!-- Login Link -->
            <p style="text-align:center; margin-top:20px;">
                Already have an account?
                <a href="{{ url_for('login') }}"
                   style="color:#1d3557; font-weight:600;">
                    Login
                </a>
            </p>

        </form>
    </div>
</section>

{% endblock %}

{% block extra_css %}
<style>
.modern-input {
    width: 100%;
    padding: 12px;
    border-radius: 10px;
    border: 1px solid #ddd;
    font-size: 15px;
    transition: 0.3s;
}

.modern-input:focus {
    border-color: #457b9d;
    outline: none;
    box-shadow: 0 0 0 3px rgba(69,123,157,0.2);
}
</style>
{% endblock %}

{% block extra_js %}
<script>

// ---------------- Show / Hide Password ----------------
const togglePassword = document.getElementById('togglePassword');
const password = document.getElementById('password');

togglePassword.addEventListener('click', function () {
    const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
    password.setAttribute('type', type);
    this.classList.toggle('fa-eye-slash');
});

// ---------------- Password Strength ----------------
password.addEventListener('input', function () {
    const value = password.value;
    const bar = document.getElementById('strengthBar');
    const text = document.getElementById('strengthText');

    let strength = 0;

    if (value.length >= 6) strength++;
    if (value.match(/[A-Z]/)) strength++;
    if (value.match(/[0-9]/)) strength++;
    if (value.match(/[^A-Za-z0-9]/)) strength++;

    switch (strength) {
        case 0:
        case 1:
            bar.style.width = "25%";
            bar.style.background = "red";
            text.innerText = "Weak Password";
            break;
        case 2:
            bar.style.width = "50%";
            bar.style.background = "orange";
            text.innerText = "Medium Password";
            break;
        case 3:
            bar.style.width = "75%";
            bar.style.background = "#f4c430";
            text.innerText = "Strong Password";
            break;
        case 4:
            bar.style.width = "100%";
            bar.style.background = "green";
            text.innerText = "Very Strong Password";
            break;
    }
});

// ---------------- Phone Format (+91) ----------------
document.querySelector('form').addEventListener('submit', function(e) {
    const phoneInput = document.getElementById('phone');
    let digits = phoneInput.value.replace(/\D/g, '');

    if (digits.length === 10) {
        phoneInput.value = '+91' + digits;
    } else if (!phoneInput.value.startsWith('+91')) {
        alert("Please enter a valid 10-digit number.");
        e.preventDefault();
    }
});

</script>
{% endblock %}
